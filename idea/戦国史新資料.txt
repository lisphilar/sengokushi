二重公儀 大坂包囲
返信 ▼
 削除 その他 ▼
 
5月4日
詳細を表示
従属や臣従しても、自立大名は自立大名であり続ける。つまり、歴史イベント以外では、自立大名が附属家になったり、附属家が自立大名になったりはしない。
自立大名は、自身に所属する附属家を併合することができる。(プレーヤー)
大坂にいる武将の所属先は自立大名本体と一緒。つまり「～隊」は作らない。
但し「協力部隊」というものを作り、盟主大名同士の会見や協力に用いる。
任意の自城Aから任意の自城Bへの移動:
Aの存在する国番号からBの存在する国番号へ順に(国番号の大小、等号を確認しておく)、在国の敵と戦いながら移動する。
但し移動できるのは5ヵ国先まで。
徒兵、騎馬隊、鉄砲のそれぞれについて、
{(ランダム値+0.8)*(1+移動する兵数+所属盟主が同じ家の在国兵数)/(1+不戦同盟軍を除く在国敵兵数)}が1より小さいとき、
(移動する兵数)にその値を掛けた兵数分、その国を通過する。
移動元の自城と武将を選択後、5ヵ国範囲でいける国(→番号が小さい5+移動元の国+大きい5ヵ国の計11ヵ国のうち、自軍が入れる場所)を一覧表示する。
移動終了後、移動人数を表示。
目的地に5ヵ国制限により行けない場合は、連盟軍との拠点交換機能を使う。
毎月始めに、最大5の自立大名が、包囲されていない拠点と当主の現在地の間で行う。
但し、当主以外の兵が、4000人以上同じ国にいる時のみ。←条件不十分




参考)以下の方法は難しい
本国の所領を管理する「毛利家」の第一附属家として「毛利隊」を作り、一つ以上の城を与えておく。
プレーヤー大名は大坂にいる部隊から選ぶが、「毛利隊」の当主が自立大名に移動すると、プレーヤーも自立大名となり、「毛利隊」やその附属家が自立大名に附属する。
初期設定では武将を持たず、派遣が決まると、自動的に各附属家の当主が「毛利隊」に入る。


F=(a-b)'+(b-c)'+(c-d)'
(但し、'は二乗を示す) について、
F=0 ⇔ a=b∧b=c∧c=d が成り立つ。

さらに、
F=(a-b)'+(b-c)'+(c-d)'+(d-a)'
(但し、'は二乗を示す) について、
F=0 ⇔ a=b=c=d が成り立つ。

従って、
変数の値が1つでも不一致なら、F≠0


皇別……（神武天皇以来、天皇家から分かれた氏族）源・平・橘・在原・高階・紀・蘇我・清原など
│
│　　　┌天孫族……（天照大神から鵜草葺不合尊迄の皇祖から分かれた氏族）菅原・大江・尾張など
│　　　│
├神別─┼天神族……（天孫族と共に皇祖の藩屏として活躍した氏族）藤原(中臣)・伴(大伴)・物部・忌部など
│　　　│
│　　　└地祇族……（天孫降臨以前から列島に居住していた氏族）大神・諏訪・宗像・安曇など
│
│　　　┌漢帰化族……（漢土に遠祖を持つ氏族）秦・惟宗・坂上・大蔵など
│　　　│
│　　　├百済帰化族……（百済に遠祖を持つ氏族）三善・多々良・菅野など
│　　　│
│　　　├高麗帰化族……（高句麗に遠祖を持つ氏族）高麗・狛・豊原など
│　　　│
│　　　├新羅帰化族……（新羅に遠祖を持つ氏族）三宅など
│　　　│
├諸蕃─┼任那帰化族……（任那に遠祖を持つ氏族）
│　　　│
│　　　├その他朝鮮帰化族……（朝鮮半島に遠祖を持つが国名未詳の氏族）
│　　　│
│　　　├渤海帰化族……（渤海に遠祖を持つ氏族）高など
│　　　│
│　　　├大理帰化族……（大理に遠祖を持つ氏族）段など
│　　　│
│　　　└その他帰化族……（その他の海外に遠祖を持つ氏族）
│
└未定─┬出自未確定……（出自に諸説が有り確定困難、あるいは僭称、偽称、仮冒が濃厚なもの）
　　　　│
　　　　└出自不詳……（系図、系譜、補任文書、伝記史料などに出自の記載が無いもの）




天皇を帝(永年)に置き換える

天地明察 沖方丁 の273ページ以降を読んで、オープニング等に生かす


二重公儀の統合 2版 「大坂籠城」
Integration of two political powers

RSSの発表が出来るようにする。

作品更新手順:前版のダウンロード数を記録→前版を削除→新版アップロード→掲示板に書く→ホームページの「履歴」を更新→ウィキィペディアを更新→ホームページのRSSを更新

Subject:武将の相続
#武将番号（）　…未登場か死亡済みだと、０を返す

武将１を強制的に当主にする・・・「-1」でも、無理やり当主にする。ただし、その武将より継承順位が高い武将が居ると、自動的に当主権が奪われてしまうので、高い武将の継承順位を「１」に変える必要あり、当主に変えたい武将の継承順位を「0」に変える必要あり。

武将１の相続権所有大名家を大名１に変更…武将１の直接所属がかわらない限り、相続はしない

大名Ａの武将１を大名Ｂの当主にする・・
・武将１の継承順位を「0」に変更→大名Ｂの現当主の継承順位を「１」以下にする→武将１を大名Ｂの所属に変更→武将１の相続権所有大名家を大名Ｂに変更(→大名Ａの新当主を決定) 


Subject:城と武将

新しい領地を与える→旧領を没収
(同一イベント内)のとき、武将は自動で動いた！

　新しい領地を与える→旧領を没収
(同一イベント内)のとき、指定された場所に武将が入りきらないときあふれた武将は、番号の遅いものが城内武将としては表示されないが、確かに存在する。他の武将が居なくなって20人以下となると、表示される。

新しい領地を与える→旧領を没収→さらに新しい領地を与える→一度目の新領を与える 
> 
> > (同一イベント内)のとき、武将は自動で動いた！
> 
> 設定された登場場所が自分の大名の所有でないとき、大名に応じて登場場所を変える！ 
> 
> 
> #支配大名()は 直轄者を示す！
> 
> 石高は確実に整数値！で、０以下は０へ！最大石高は常に優先！
> 
> 変更後の大名の城に移動させなくても、武将の所属を変えれば、自動的に変更後の大名の城へ行く
> 
> 強制移動を命ぜられた城が自分の大名家のものでない場合、移動しない
> 
> 主家Ａと家臣家Ｂ
> 　Ｂの城をすべて、併合せずにイベントで他の家に移すと、城なし大名としてＡにそのまま家は存続して臣従。武将もそのまま。
ただし、攻められて移ると、Ｂは消滅。また、併合でも、Ｂは滅亡。



Subject:スイッチ方式
スイッチを切り替えるためには変数SWITCHに-1を掛けます。
変数(SWITCH)に演算式(SWITCH*(-1))を代入
これでオンの状態のときはオフに、オフの時はオンになります。
繰り返しイベントで用いる場合などに用いると良いと思います。
そして後は条件にオンの時（変数SWITCH＝1）、オフの時（変数SWITCH＝-1）と、（不等号や、足し合わせるのもアリ）することで分岐に用いられるわけです。
ちなみにこの切替スイッチを使えなくするためには、
(SWITCH)に演算式(0)を代入でＯＫです。
（注：条件によっては引っ掛かります（変数SWITCH ＜ 1 など））

◇1オン、2オン、3オンの時
条件　SWITCH1 + SWITCH2 + SWITCH3 ＝3
◇1と2のオン・オフが逆の時
条件　SWITCH1 + SWITCH2 ＝ 0
又は　SWITCH1 ＝ SWITCH2*(-1)
◇1オン、2オフ、3オフ、4オンの時
○　SWITCH1 + (SWITCH2*(-1)) + (SWITCH3*(-1)) + SWITCH4 ＝ 4
×　SWITCH1 + SWITCH2 + SWITCH3 + SWITCH4 ＝ 0
⇒1オフ、2オン、3オフ、4オンといった場合でも通るので。


季節イベントとは、大雨、台風、大雪…などが有名どころでしょうか。
この確率は一見変更できないように見えます。確かに、直接変更は出来ません。
ではどのように変更するか、それでイベントです。要は確率を変更すれば良いので、以下のようにすればOKです。
> 例：1年交替で大雨・大雪が降る確率が変わる
> ◇発生条件
> 変数　YEARFLAG　に　1　を加算
> 変数　YEARFLAG　＝　1
> 変数　YEARFLAG　に　0　を代入
> 
> ◇発生イベント
> 季節イベント　E_OOYUKI　を発生させる
> 季節イベント　E_OOAME
> 
> ◇もう一つの方の発生条件
> 変数　YEARFLAG　＝　0
> 関数　#Random　＜　0.50
> 
> ◇発生イベント
> 季節イベント　E_OOYUKI　を発生させる
> 季節イベント　E_OOAME　を発生させる
> こんな感じです。
> これで1年交替で大雨・大雪の確率が2分の1になります。
> 
> また、これで設定できるのは全体的な確率変更です。
> 現状では地域限定は出来ません。年月は条件で変更は出来るでしょう。
> 
> ところで、季節イベントは毎回イベントを設定しなくても発生しますので、
> あらかじめ季節イベントの方を絶対に発生しない期間（0年より前など）に
> 設定しておいてください。設定によっては二度発生してしまいます。
> 
> また、「季節イベントを発生させる」イベントは、内部の確率に準じ、
> 発生しないと判断すると表示されません。
> ここらへんは普通の季節イベントと同じです。
> イベントで呼び出せば必ず100%起こるとは限りません。
> （起こしたいのであればその月を100%にするしかありません例：勢力紹介） 
> 
> 年数や、季節イベントの組み合わせ、季節イベントごとに確率を設定などで、「冷夏」の年や「エルニーニョ」「ラニーニャ」の年を再現できるのではないでしょうか。
> また季節イベントで表せるのは「災害」や「兵数減少」だけではなく、単なる情報表示、(勢力紹介、天皇勅令発布等）にも使えます。
そして条件は年月だけでなく、ある特定の城占拠や資金等にしても良いと思います。


ミッション達成型シナリオ
自由度の高い戦国史のシステムを逆向きに活用する。複数の条件イベントを使う。
特定の大名家でプレイすると、ＯＰ直後に最初の条件イベントが発生。その際、達成すべき目標が言い渡される。（例、先祖の居城であった城Ａを奪還せよ。）この目標を達成すると、第二の条件イベントが発生し、さらに次の目標が与えられる。そしてこの目標を達成するとさらに、、、。という具合。


捕虜かどうかを確かめるには、#捕虜大名(武将ＩＤ)>0を使えば良い


数値の小数点以下の四捨五入や切捨て
戦国史の変数は実数であるため、割り算等をおこなうと数値に小数点以下の数値が発生することがある。しかし、資金や兵数をメッセージで表示する場合、小数点以下の数値が表示されるのは不自然である。そこで、小数点以下の切捨てや四捨五入を行うためには次のようにする。

a.. 数値処理用の無城大名Aを作成する。
b.. 小数点以下処理をしたい変数名をShosutenとする（12.7という値と仮定）

いつでも 何回でも 
a.. 切捨て処理を行う場合
大名1の資金をデータ1にする（大名1に数値処理用大名A、データ1にShosuten）
代入（データ1にShosuten、データ2に#資金(数値処理用大名AのID)）
a.. 四捨五入処理を行う場合
a.. 大名1の資金をデータ1にする（大名1に数値処理用大名A、データ1にShosuten+0.5をセット）
b.. データ1にデータ2を代入する（データ1にShosuten、データ2に#資金(数値処理用大名AのID)をセット）
この結果、変数Shosutenには切捨ての場合は12、四捨五入の場合には13がセットされる。 
<条件にAnd文とOr文を含ませる> 
→n次方程式の利用
ちなみに、n次方程式の考え方を応用すると、n次不等式を用いることで条件の範囲指定も可能。
例えば、開墾が可能な月(1,2,9,10,11,12)は次の条件で表される。
a.. 条件 (#month-3)*(#month-8)>0


ランダム変数の保持
（ここではランダム関数を代入した変数をランダム変数と呼ぶことにします）
保持する理由は戦国史のシステムに沿ったイベント作成のためです。
戦国史のシステムにはある程度の規則性があり、嫌な結果が発生したからといっていくらデータロードを繰り返しても結果が180度変わることはありません。（何かしら明らかに違う行動を取らない限り） 
…が、ランダム変数はそういった戦国史のバランスを崩してしまいます。
それはプレー毎にランダムになってしまうので「この嫌なイベントは起こさせたくないなぁ…」と言う人がロードして始めると条件にあてはまらなくなるまでランダム変数を変えることで乗り越えてしまいます。
それを防ぐための変数保持です。
今回はその一つの方法である「ターン保持」です。つまりはターンごとに使用するランダム変数を変え、残りの変数を保持しておくのです。 
以下は「3ターン保持」のランダム変数です。
◇初期設定としてランダム関数の有理化等で
RAND1　RAND2　RAND3　の3つを生成しておく。

◇ランダム変数をターンごとに使用する。（変数切崩法）
（変数RANDCNTは初期値0、変数RANDが実際に使用するランダム変数）
変数RANDCNT　に　1　を加算
変数RAND　に　変数RAND1　を代入
RANDCNT　＞　1
変数RAND　に　変数RAND2　を代入
RANDCNT　＞　2
変数RAND　に　変数RAND3　を代入
変数RANDCNT　に　0　を代入

◇使用したランダム変数に違う値を代入する（例は変数RAND1の場合）
RANDCNT　＝　1
変数RAND1　に　#Random　を代入
（以下有理化）
以上のように構成することで、実際に使われるランダム変数は3ターン前に生成されることになります。
（ただし、最初から始めて1～3ターン目までは結果が変わります）

確かに3ターンまで遡れば結果は変わってきますが、 そこまですると戦国史本体の結果も変わってくるので、それは「想定内」「戦国史本体に似たシステムになった」と思って頂ければ＾＾；

まだまだ保持させたい方は5ターンでも10ターンでも良いと思います。
良いとは思いますが、結局1ターンで使用できるのは1つのランダム変数です。

（抽出された）いくつものランダム変数を使う場合には、
3ターン程度が目安ではないかと思います。
> 


観戦モードの時のプレイヤー大名変数は、
「全大名数」の値です。
つまり、全部で100の大名家が存在しているシナリオでは「#プレイヤー大名」の値は「100」となります。
それは番号が0～99に大名家が100個存在しているので、100番目の大名の次、101番目（大名番号は100）が観戦モードとして認識されます。
従ってイベントで観戦モードを検出したいときは、そのような条件を付けてあげると良いでしょう。観戦モードでプレイヤーが行き来して計測が狂うのを防ぎます。
１．プレーヤーが観戦モードかどうかを判断する方法
普通なら#プレーヤー大名を参照すると、その大名家のIDが指定された変数に代入されます。
しかし観戦モードだと全ての大名数＋１の数が代入されます。（つまり、総大名数1000だと、観戦モードのIDは1001）
従って条件に、「#プレーヤー大名　= 1001」なんかを設定することで観戦モードかを判断することができるんですね。
マクロを使用!


武家に対する二つの政権の統合

　＝　Integration of two political powers into samurai


　　武家に対する二つの政権による政治体制

　＝　Political dispensation by two political powers to samurai

Subject: 城石高の調整
<城石高の調整>※最大石高が優先されます。
加算：発生イベント「大名1の全城の石高にデータ1を加算」を大名ループで行う。
若しくは、発生イベント「城1の石高にデータ1を加算」を城ループで行う。
～倍：各城の石高を関数「PreCC」に代入→「～倍(X倍とする)」した値(=FolCC)を各城の石高に設定
※最終的に整数値(自動的に小数点以下切り捨て。但し四捨五入も可能)になる。
※石高0の城は、0のまま変化なし。(海上拠点等)

「石高計算用の大名A(武将なし)」と「マップの外にある城α(大名A初期所有、無石高)」を使う。其々IDを、「DA」、「Sα」とする。いずれも架空の、石高調整に特化されたもの。
　１、城石高調査+石高変更イベント（城ループ：LS)
条件:「LS」≠「0」
効果:「Shiro１」に「LS」代入。「Daimyou1」に「#城支配大名(LS)」を代入。
Shiro1を「大名A」の領地へ。「城α」を「Daimyou1」の領地へ。
Shiro2に「#城番号(Sα)」代入。
サブルーチン呼び出し「２、武将移動イベント」
「PreCC」に、「#直轄石高(DA)」を代入。　　　/…変更前石高の調査終了。
「城1の石高にデータ1を加算」…城１=Shiro1、データ１=-9999999　　　　　　/…一旦石高を0にする。
「FolCC」に「PreCC」と「X」の積を代入。
「城1の石高にデータ1を加算」…城１=Shiro1、データ１=「FolCC」　　　　/…石高変更終了。
Shiro1を「Daimyou1」の領地へ。「城α」を「大名A」の領地へ。
Shiro1に「#城番号(Sα)」代入。
Shiro2に「#城番号(LS)」代入。
サブルーチン呼び出し「２、武将移動イベント」　　　　　　　　　


２、武将移動イベント（武将ループ:LB)
条件:「#城武将数(Shiro1)」が「１」以上である。
「BushouA」に「LB」代入。「ShiroA」に「Shiro１」代入。
「BushouA」が「ShiroA」に居る。

効果:「Bushou1」に「LB」代入。
武将「Bushou1」を「Shiro2」に移動。


◆最近接入場可能拠点検索
※絶対に存在するときのみ行うこと!!
(総城数≧2)
存在しない時に行うと終わらない。
:代数x…元々いた城の番号
:代数y…開始前に1代入
:代数z…探す城の領主又は臣従先番号
(zの条件による応用可能)
:結果x…最近接入場可能拠点番号
:CE_0076…値ABCの絶対値化を行う。
(イベント)
条件: y＝1 ∪ (x)*(完全総城数-x)＜0 ∪ xの城の領主又は臣従先番号がzに等しくない
(⇔元の城ではなく、範囲内かつ移動可能なら止まる)

結果:xにy加算、ABCにy代入、CE_0076呼び出し、代数aにy/ABC代入(正負を調べる)、yにABC+1代入、yに-y*aを代入、自身呼び出し
(一点から両端に検索するシステム)


◆最近接家検索
存在しない時に行うと終わらない。
:代数x…自身の大名番号
:代数y…開始前に1代入
(zの条件による応用可能)
:結果z…最近接大名番号(開始時は＝x)
:CE_0076…値ABCの絶対値化を行う。
(イベント)
条件: y＝1 ∪ (x)*(完全総大名数-x)＜0 ∪ x家とz家が近接
結果:zにy加算、ABCにy代入、CE_0076呼び出し、代数aにy/ABC代入(正負を調べる)、yにABC+1代入、yに-y*aを代入、自身呼び出し
(一点から両端に検索するシステム)


外交関係:宿敵、敵対、不戦、連盟、附属

▲自立大名=軍事・内政的な干渉を受けることがなく、鞍替えや独立を自由に行える。豊臣譜代、徳川譜代、旧属大名の区別なし。家臣家の反対語。

▲家臣家:一定の自立大名の外交干渉を受ける家。一方(元自立大名)がが他方(自立大名)に半永久的に臣従(後者が盟主の場合)、または後者の盟主に従属(後者が盟主以外の場合)する。石高が0.95万石未満、又は自動外交で臣従すると強制的に家臣化(盟主へ)、20万石以上になると自立大名化。

▲連盟:一方が自立大名のまま他方(交代制盟主)に従属(派遣軍の場合は臣従)。経済協力、援軍の相互派遣、領土交換が可能。

▲交代制盟主=自立大名同士が組んだ連盟の主家にあたる家のことで、所属する自立大名の中から、石高が一番高い大名が4月に、二番目に高い大名が10月に選ばれる(盟主の外交関係が引き継がれる)。


◆プレーヤー大名の流れ
自立大名の自由外交を認めるか決定、連盟設定(自立なら3家に対して連盟参加要請)
→全主要城所有を目指す。
→京へ。

◆勝利

① 全ての第一主要城を所有。
山城の拠点全てを盟主として所有。

② 所属する連盟盟主が①を達成。

③ 主家が①を達成。(家臣家)


実際の石高ランキング
indexは順位、関数CRD系の値は大名番号
LDは大名番号、関数CR系の値は順位

大名:ICR[LD]、ICRD[index]、#直轄石高順位大名(順位)、DCrop[LD] (自立番号LD)
連盟:FCR[LD]、FCRD[index]、#石高順独立大名(順位)、MCrop[LD] (盟主番号LD)

実際の大名石高ランキング:ICRD[index]
indexは順位、関数の値は大名番号
予め、自立大名石高をDCrop[LD]に全て代入しておく。
まずLに1代入、Tに0代入
　　<イベントA>
城ループ:index 但し、1以上
条件:ICRD[index]に0代入
以下、生存大名数以下なら、
ICRD[L]に#直轄石高順位大名(index)代入
以下、ICRD[L]が自立大名なら、Lに1加算
(自立以外なら、自動的に上書きされる)

<イベントB>:Ａと独立した次のイベント
条件:TがL-2以下
結果:Tに1加算
Sに0代入
イベントCを呼び出し
イベントBを呼び出し

　　<呼び出しイベントC>
条件:T+SがL-2以下
結果:Sに1加算
イベントDを呼び出し
イベントCを呼び出し

　　<呼び出しイベントD>
条件:ICRD[T]がIDCR[T+S]よりも小さい
結果:ICRD[T]をhに代入
ICRD[T+S]をIDCR[T]に代入
hをICRD[TS]に代入
Sに1代入
イベントDを呼び出し

　　<独立イベントD>
城ループ:index 但し、1以上L-1以下
結果:ICRD[index]をhに代入
ICR[h]にindex代入

◆Syuke[LD] 家臣家なら所属自立大名番号。自立大名家なら自身の番号。滅亡すると0。天皇・裏方は全て0。

◆CE_1004 城PreMoveの武将を城FolMoveへ。
のしくみの武将ループを、1から加算する方式+PreMoveの武将数が1以上、に変える。

◆初期家臣家はプレー不可。

『日本の城』の折り込みページ「日本の城郭年表」を見て、慶長築城ブームの部分を城情報に追加

◆主要城の近くに、ラベルを貼る。

◆※築城に注意
貿易の修正 地方内政 外国勢力 

◆連盟内の拠点分配:城ループ
先月イベント末とその月始めについて、直轄所有大名と、城所属連盟が共に異なり、かつ現在の城所属連盟の盟主がプレーヤーでない場合。
ランダム値の20倍の整数値+1を対象の城の武将数以下にし(割り算と引き算)、その値αについて、α番目に若い武将(その城に居る)の直接所属家(家臣含む)に渡す。
但し、大坂の場合は大名のみ。
プレーヤーに渡された場合は知らせる。

◆全体として、自動裏切りは1にする。臣従は2、従属は4。

◆国毎にプレーヤーとその臣従家の武将集合
以下、城ループのイベントの呼び出しで、
条件:国管理の城
結果:nに0代入

条件:n=0
プレーヤーまたはその臣従家の城、
武将数が一人以上いる、未包囲
結果:nにその城番号代入

条件:nが0に等しくない
プレーヤーまたはその臣従家の城、
武将数が一人以上いる、未包囲
結果:城番号nに武将移動(CE_1004 城PreMoveの武将を城FolMoveへ。を利用)


◆真田丸は城内
◆大坂城の堀:
'非'滅亡管理家「(空白)」が管理。一つあたり20名の武将「堀番」が、計10万の兵(武将一人鉄砲100、統率力強、馬なし、金なし、拠点レベル5、軍船あり、堀を出るか、捕虜になると死亡)を率いて守る。出陣できない。東軍に対してイベント強制宿敵、西軍に対してイベント従属。
◆大坂の外堀:内外を一般道で結ぶ。外堀同士は見える水路で結ぶ。番号を連続させる。
◆豊臣氏の領地のうち大坂以外の拠点(＝東軍に占領された拠点)は、全て滅亡済前宿敵裏方管理家「荒れ地」が支配する。
◆東軍自立大名の配置終了
◆意思表示の国は廃止

Subject: 意思表示
毎月の複数選択肢の質問で行う

◆大名・連盟情報表示

◆イベント解説

◆連盟を組む
プレーヤーの加入は、外交フェイズで行う。
不戦同盟の自立大名に対して使者を送る。
以下その家とプレーヤーについて計算。

◆主要城設定
国の中で番号の若い1～3城について、4・10月にその支配者を表示する(勢力図情報)。
表示: 「城名:連盟(自立大名の直接支配家)」
■畿内
◆山城
◎二条城:徳川家連盟(徳川家の直轄支配)
○伏見城:徳川家連盟(徳川家の直轄支配)
○

◆現在の目標の確認(非観戦)
達成率をパーセント表示

◆プレーヤー武将の移動強行
味方の城で繋がっていない城に武将を移動させる。(一人ずつ)
全国マップ内:移動先の城のある国に達するまで主要城ごとに戦闘。
大坂内:番号を一つずつ下げていって一拠点ごとに戦闘。
その際、城ごとに、直轄城主と敵対かつ城に武将がいるなら、兵種ごとに、兵数の差分の、15*(ランダム値+0.5)分の一が、少ない方から引かれ、移動軍の元の数の50分の一が、多い方から引かれる。

◆大名時外交切換え(本来のシステム以外)
連盟参加(単独相手なら従属させる、盟主相手なら従属するか従属させる)、従属・臣従切り替え

◆盟主→自立大名の城交換要求
プレーヤーのみ。
国→城ループで行う。
但し、各国について、第一主要城を連盟の誰かが所有していなければできない。
減らされた拠点数分、必ず他の拠点を与えなければならない。大名石高も各々変わらない(城同士入れ換え、但し最大石高には従う)。また、盟主が、城にいた武将の兵数と城石高と城経済の100倍の資金を払う。


◆自立大名→家臣家
武将入れ換え:大名家か家臣家の当主のいる城の武将について行う。

石高変更:各家石高一律変更(数値記入)

城変更:
国ごとに城情報表示→※
※大名直轄なら、家臣に与えるか聞き、与えるなら大名ループで附属を探す(検索開始点は変動、最後まで行ったら、本当に与えるのか聞いて最初へ戻る)→家臣情報表示→与える→附属or大名情報表示
※家臣領なら、直属に変更するか聞き、変更するなら、城を直属に改め、家臣&大名情報表示

◆拠点割譲
大名か盟主に城変更を願い出る

◆大坂城の堀の埋立
大坂城主の場合
堀の一つを選択→その城を城主の所有へ。
→城レベルが0へ。
停戦:CPUの和睦を受け入れるか、他の自立大名に従属する。(強制転封)
城主以外の場合
大坂の堀の外の陣地すべてがプレーヤーの連盟所有※真田丸は城内
→堀管理家が大坂城主に武将死亡併合され(行う前の説明では、外堀のみ)、大坂町の陣地すべてが城主の直轄、大坂町の周りの全国マップ都市複数も城主直轄、大坂石高回復、「荒れ地管理家」が大坂城主直轄、プレーヤー盟主に所属大名が臣従。

※以下プレーヤー以外
大坂城主の資金が0以下、外堀すべてを城主が所有、大坂の堀の外の陣すべてが同一連盟所有
→堀の城レベルが0へ、堀管理家が大坂城主に武将死亡併合され)、大坂町の陣地すべてが城主の直轄、大坂町の周りの全国マップ都市複数も城主直轄、大坂石高回復、「荒れ地管理家」が大坂城主直轄、盟主にプレーヤー外の所属大名が臣従。

◆大坂城内への大筒の撃ち込み
城主に敵対する家が堀のすぐ外の拠点一つに鉄砲を1000以上集めると、それに対応する城内部の同一方面の拠点の城レベルが0.3*鉄砲数/800ずつ下がる(関数管理)。
特に備前島に1000集めると、天守閣が0.4*鉄砲数/8000下がる。
また、10000以上集めると城中心部の拠点の城レベルが0.15*鉄砲数/8000ずつ下がる。

「大坂籠城」大坂計画
返信 ▼
 削除 その他 ▼
 
8月29日
詳細を表示
◆大坂側の武将と兵数決定。複数名配下のいる浪人家は、無城家臣家としてスタート、配下武将のいない浪人は豊臣直属武将へ。
冬の陣計:約10万人
開始直後に、(#Random/2+0.75)をかける。
但し真田丸には最大数の鉄砲を配置。

◆大坂町整備。
◆大坂城(国:大坂町に所属)は、天守閣を持っている大名の所有とする。大坂が統一される(天守閣と全ての出口を同じ連盟が所有)と、全ての大坂拠点が大坂城主直轄になり、最大城石高が回復する。大坂の「至～」と「外砦」は見えない道で繋げる(両端は見える)。大坂城は他の拠点とつながらない。砦同士の自動移動はなし。

◆徳川系を家臣家と連盟大名にわける。

◆家康は勘定所当主

◆毎月始めに大坂陣数関数を設置。
the number of the family's camps in Osaka:CAPOC[LD*100+index]
城ループ
LD*100+0に、大坂内の陣の数＝α
LD*100+indexに、陣の番号。
但しindex＝1～α
直轄城数-陣数＝一般拠点数

◆ 大坂冬の陣の状態へ
江戸初期の軍役
一万石-鉄砲20丁、馬上14騎、兵卒250名
に従って、初期兵数は、各家ごとに、
(#Random/2+1.0)*(1万石当たりの規定兵数)*#直轄石高(LD)/10000/#直轄足軽兵数(LD)ー1を三つのindex関数に記録する
→武将ループで、
武将1の足軽兵数にデータ1を加算
データ1:所属大名の関数データ*武将1の足軽兵数

※予め全ての武将について、兵数や騎兵数、鉄砲数を1以上にしておくこと。但し統率力0を除く。

◆冬の陣計　東軍約20万人
当主等必ずいるべき人はは予め陣に入っている。
大坂に初期から陣を持つ大名の直轄石高の和を計算(初期外交設定時)ProtoDispCrop
→大坂東軍(⇔西軍でない∧大坂陣あり)について、予め大坂にいる武将の兵数の和を200000から引き算 ProtoDispNum
→(以下該当大名ごとに)
ProtoDispNum[LD]＝(#Random/2+1.0)*ProtoDispNum*直轄石高/ProtoDisp を計算
→武将ループで、
ProtoDispNum[LD]に一般兵卒数が達するか、全ての武将が大坂入りするまで(条件不要)、直属武将が当主のいる城へ(ProtoDispNum[LD]から兵数を引く)。

◆大坂外摂津に拠点を持たない大名:徴兵
大坂内の拠点にいる武将にも徴兵できるが、毎月始めに、大坂内の兵の総計最大値(直接所属家ごと)に制限(先月のイベント末に、大坂内の総兵数を計算)がかかる。従って、援軍武将が来ない限り、大坂にいる兵数は増えることはない。
最大値を越えた分については、イベント始めに、家ごとに、大坂にいない番号の一番若い武将に全て渡す。
大坂内兵数最大値関数:兵種ごとに作る。

◆注意:武将移動のイベント使用時にはかならず、包囲されていないか調べる。

◆大坂と領国:プレーヤー所有外加算式城ループ
両方存在するときのみ。
主要城の場合、0.3の確率で大坂(CAPOC[LD*100+1])に全ての武将が強行移動。
大坂の拠点の場合、0.1の確率で、拠点にいる全ての武将が最近接入城可能拠点へ強行移動。(1拠点の場合は自動的に外へ)

◆強行武将移動(プレーヤー以外)
大坂内拠点を、出口とその出口に近い拠点とでまとめて並べておく。大坂町の最初と最後が出口になるようにする。
元の城と相手の城の番号の大小を調べておく。
全国マップ内:移動先の城のある国に達するまで第一主要城ごとに戦闘。
大坂内:一拠点ごとに戦闘。
その際、城ごとに、直轄城主と敵対かつ城に武将がいるなら、兵種ごとに、兵数の差分の、15*(ランダム値+0.5)分の一が、少ない方から引かれ、移動軍の元の数の50分の一が、多い方から引かれる。

●初月
関数設定
大名・家臣家設定後、東軍全てが徳川に従属、特に徳川親藩・譜代大名(結城・長澤以外)は徳川に臣従。
イベントや外交について説明。
勝利について説明

●翌月:連盟結成依頼
(プレーヤーが徳川や豊臣以外の、大坂にいる自立大名)
豊臣に従う場合でも、まずは連盟設定(豊臣従属は外交フェイズで)
最近接大名(検索結果)に誘われる
新たな連盟を立てるなら、誘った大名と、同じ家系の自立大名が必ず従属(家臣家は必ず臣従)。徳川とは不戦のまま。
大坂にいる自立大名全てを一覧表示して、連盟を組みたい家について順に計算
認められると、プレーヤーに相手が従属。
断られると、その家と敵対、それ以上その月は組めなくなる。
その後、徳川と豊臣以外の、プレーヤー以外の自立大名全体に対して、連盟組直しを行う。(徳川と不戦のまま。大名ループとランダム大名について)

◆初期外交判断
家臣家なら主家について適用

▲盟主が違うとき
自立石高順位の高い大名の盟主に他方が従属、盟主なら自動的に連盟全体に適用
1.5≧s*u*w≧0.5

▲盟主が同じとき
1.5≧s*u*w≧0.5 
自立石高順位の高い大名に他方の大名が従属して新連盟を立ち上げ(独立、元の盟主と不戦同盟)、そして、元の盟主(徳川含む?)と新盟主について再度この計算を行う。

外交変更代数
返信 ▼
 削除 その他 ▼
 
8月29日
詳細を表示
◆大名aとbの外交判断基準
a&b's criterion for judgement:
プレーヤーの場合、実際にそうするかどうかはプレーヤーが決定
自立大名同士にのみ適用(家臣家なら主家について適用⇒家臣家が多いと外交も多い)
ランダム大名のSyuke[LD]と、最近接大名(検索結果)について行う

▲1以上の方に他方が臣従+家臣家へ
一以下の方が石高が10万石以外であり、
「LAdB≦0.2 ∧ LBdA≧1.8」∨「LBdA≦0.2 ∧ LAdB≧1.8」

▲不戦・敵対相互入れ換え
盟主が同じでないとき、
盟主なら自動的に連盟全体に適用。
1.8＞LAdB＞0.2 かつ 1.8＞LBdA＞0.2
(但し 不戦 かつ 1.5≧LBdA≧0.5 ∨ 1.5≧LBdA≧0.5 に適さない)

▲不戦なら連合へ
盟主が違うとき、
自立石高順位の高い大名側の盟主に、他方の自立大名が従属、盟主なら自動的に連盟全体に適用
1.5≧LBdA≧0.5 ∧ 1.5≧LAdB≧0.5 

盟主が同じとき、
1.5≧LBdA≧0.5 ∧ 1.5≧LAdB≧0.5 
なら、石高の大きい大名の盟主に他方の大名が従属して新連盟を立ち上げ、そして、元の盟主と新盟主について再度この計算を行う。

◆Region[LS]、Country[LS]の設定時
Region2[LS]・Country2[LS]として北から数えて何番目の地域かわかる関数をつくる

◆大名家aのbに対する攻撃可能性
代数:the likelihood of a's defeating b :LAdB
:1より大きいとき、aはbより強い

#当主城(a)＝c、#当主城(b)＝d
#主家大名(a)＝x、#主家大名(b)＝y

LikAdefB＝z*s*u*w/t

(揺らぎ)＝z＝0.5*#Random+0.75 

s＝|#城武将数(c)ー#城武将数(d)|/10+0.1
: 0.1≦s≦2.0

z*s*u*wが1.0より小さいとき
t＝|Country2[c]ーCountry2[d]/20|+0.8
但しtが2.0以上のとき8.0で割る

z*s*u*wが1.0以上のとき
t＝ー|Country2[c]ーCountry2[d]/10|+1.6
但しtが0以下のときtを正にして4.0で割る

u＝|#直轄石高(a)/#直轄石高(b)*[#直轄足軽兵数(a)+3*#直轄騎馬兵数(a)+5*#直轄鉄砲数(a)] / [#直轄足軽兵数(b)+3*#直轄騎馬兵数(b)+5*#直轄鉄砲数(b)]|

w＝|#城数(x)*#経済(x)*[#従属大名数(x)+2*#臣従大名数(x)+1] / #城数(y)/#経済(y)/[#従属大名数(y)+2*#臣従大名数(y)+1]|

[@wiki]
http://www29.atwiki.jp/asscicule/
ID : asscicule

旧ホームページはシナリオ説明用に残す。
化生の説明ページと歴史関連の説明ページに分ける。
歴史のページでは、戦国史シナリオがなくてもわかるような説明をすること。シナリオの更新も別に行う(更新時にオープニングに歴史詳細目次アドレスを併記)。

大坂籠城 作成待ち関数
返信 ▼
 削除 その他 ▼
 
8月29日
詳細を表示
◆Region[LS]、Country[LS]の設定時
Region2[LS]・Country2[LS]として北から数えて何番目の地域かわかる関数をつくる
(第二国関数、第二地域関数)

◆附属家のグループ分け関数 FDG[index]
※index=(自立大名番号)*100+α
※α=0のとき、家臣家数 / α=1～「α=0の値」のとき、家臣家番号を返す。

◆設定方法(初月)
※大名ループで、はLDが家臣家の時
・Syuke[LD]*100 を代数 index に代入
・FDG[index] に 1 加算
・index に FDG[index] 加算 
・FDG[index] に LD 代入 
以上

※変更方法(イベント上の方)
・大名滅亡…その大名用の開始点から、「α=0の値」個のindexについて削除。
・特定家臣独立・滅亡…自身イベント呼出式で、その家の番号が代入されているindexを探して削除、その大名の最後尾indexの家臣を空白となったところに代入(上書き)、最後尾削除、「α=0」から1引く。
(上記、戦闘滅亡時を含む)
※特定大名情報調査に応用。

◆自立大名のグループ分け関数 ING[index]
※index=(盟主大名番号)*100+α
※α=0のとき、所属自立大名数 / α=1～「α=0の値」のとき、自立大名番号を返す。

◆設定方法(毎月)
※大名ループで、
以下はLD(盟主以外の自立大名のみ)の時
・盟主のLD(主家番号)*100 をindexに代入
・ING[index] に 1 加算
・index に ING[index] 加算 
・ING[index] に LD 代入 
以上

※特定盟主情報調査に応用。

※計算前に、現在の盟主について、α＝0の値を0にする。この関数を使うときは必ず、本当に盟主か確認すること。


新版 大名領土分布
返信 ▼
 削除 その他 ▼
 
8月29日
詳細を表示
連盟領土分布関数:MSCAC[index]
index:(盟主番号)*(第二国番号最大+1)+α
α＝0:連盟総城数
α＝第二国番号:その国の連盟総城数
自立大名領土分布関数:ISCAC[index]
index:(自立番号)*(第二国番号最大+1)+α
α＝0:大名総城数
α＝第二国番号:その国の大名総城数

◆国の城占有率
Country[Country[拠点]]か、Country[国管理城]で国の最後尾が求まる。
Country[国管理城]-国管理城番号が、国の総城数。この値で、Country2[国管理城]をαとして求めた大名の国の総城数を割って100倍し、四捨五入

◆初期設定:城ループ(大坂町外)
Syuke[#城支配大名(LS)]をAに代入
indexに(A)*(第二国番号最大+1)代入
ISCAC[index]に1加算
indexにCountry[LS]加算
ISCAC[index]に1加算
#主家大名(A)をAに代入
indexに(A)*(第二国番号最大+1)代入
MSCAC[index]に1加算
indexにCountry[LS]加算
MSCAC[index]に1加算

◆更新:城ループ(大坂町外)
①Syuke[Prelord[LS]]とSyuke[#城支配大名(LS)]が異なるなら、
Syuke[Prelord[LS]]をAに代入
indexに(A)*(第二国番号最大+1)代入
ISCAC[index]に-1加算
indexにCountry[LS]加算
ISCAC[index]に-1加算
Syuke[#城支配大名(LS)]をAに代入
indexに(A)*(第二国番号最大+1)代入
ISCAC[index]に1加算
indexにCountry[LS]加算
ISCAC[index]に1加算
②をAに代入
#主家大名(Prelord[LS])と#主家大名(#城支配大名(LS))が異なるなら、
#主家大名(Prelord[LS])をAに代入
indexに(A)*(第二国番号最大+1)代入
MSCAC[index]に-1加算
indexにCountry[LS]加算
MSCAC[index]に-1加算
#主家大名(#城支配大名(LS))をAに代入
indexに(A)*(第二国番号最大+1)代入
MSCAC[index]に1加算
indexにCountry[LS]加算
MSCAC[index]に1加算
③包囲されていて、かつ直轄所有者が従属中の家臣家で、直轄城数2以下なら、所属大名に併合される。
④包囲されていて、かつ直轄所有者が臣従中の家臣家で、直轄城数1なら、所属大名に城を渡す。


※関数の英字名称の簡易なつけ方
D:家 / I:自立大名 / K:家臣家 / 
M:盟主、連盟 / G:集団 / S:拠点 / 
F:全か無か / C:数、石高、国 / 
E:経済 / R:割合、順位、地域 / 
P:前、先行 / L:所有 / A:分布 / 
Del:delegation=代表の団体・任命・派遣 /

＜大名常用関数＞
◆Syuke[LD] 家臣家なら所属自立大名番号。自立大名家なら自身の番号。滅亡すると0。天皇・裏方は全て0。
※家臣・盟主共に、交代制盟主は#主家大名(LD)で計算できる。

KDG[index] 家臣家のグループ分け関数 
※index=(自立大名番号)*100+α
※α=0のとき、家臣家数 / α=1～「α=0の値」のとき、家臣家番号を各々返す。

ING[index] 自立大名のグループ分け関数 
※index=(盟主大名番号)*100+α
※α=0のとき、所属自立大名数 / α=1～「α=0の値」のとき、自立大名番号を返す。

＜城関数＞
Region[LS] と Country[LS]
国関数に国管理を代入すると国最後尾、
国関数に一般城を代入すると国管理城、
域関数に域管理を代入すると域最後尾、
域関数に一般城を代入すると域管理城。

Prelord[LS] 先月イベント終了時の城の所有家番号を返す。

＜代数＞
DSTART～DEND 現地軍の範囲。
Kansen 観戦時のプレーヤー番号(CE_101設定)
SOUZYOUSU 城区分「一般」の拠点の数。

＜システムイベント＞
CE_0076 ABCに代入された値の絶対値化。
※元の値を結果で割ると-1か+1が出る。

CE_0111 ChMonthの値を12以下へ(月処理)
ChYearに1加算

CE_1004 城PreMoveの武将を城FolMoveへ。
CE_1003 城番号TSの石高を PreCC[TS] に返し、経済値を CECO[TS] に返す。
CE_0001 自立同盟・大名家全体の情報を取得する。石高、経済、城数、の順に、
同盟:MCrop[LD] MEco[LD] MShC[LD]
大名:DCrop[LD] DEco[LD] DShC[LD] 
CE_0003 大名TDの情報(CE_0001)を表示。
CE_0048 盟主TDの情報(CE_0001)を表示。


Ａの二以降では、「中公文庫 日本の歴史13 江戸開府 辻達也」を参考にする。 

「崩壊」用イベント
返信 ▼
 削除 その他 ▼
 
8月12日
詳細を表示
戦記システム 

※臣従武将集合イベント
⇒直属・臣従武将を国毎に一ヶ所にまとめたり、地方毎にまとめたりできる。
◆国番号設定
⇒一国譲渡や国名表示に利用できる。
(随時城エリア関数による制御必要)
国関数に国管理を代入すると国最後尾、
国関数に一般城を代入すると国管理城、
域関数に域管理を代入すると域最後尾、
域関数に一般城を代入すると域管理城。

①北から順に完全に国毎に城を、テキストエディタで並べる。地方内の順は気にしない。大坂は一色単にし、摂津の中へ。大坂と摂津を繋ぐ。
②大名に、空白家2家(国管理と地方管理)をつくる。Syuke[]は、他の空白家同様の値。観戦番号に1加算。大名は自動自滅。
③一日でわかる江戸時代P38を参照。城の国グループの頭に城を作り、名称を各々の国にし、所有を城管理家にする。(見えない所)地域毎にまとめ、国番号がわかるようにする。IDを国番号にする。地方についても同様。分割された国の場合は、「陸奥-白河」のようにする。城エリアはいずれも六。町拡大マップは各々の所属国に含ませる。
④イベント1以上の城ループ
国管理家所有なら、国関数の前国表示代数に、城番号-1を代入、代数に城番号代入。
域管理家所有なら、域関数の前域表示代数に、城番号-1を代入、代数に城番号代入。
上記二点以外なら、国関数の城番号に前国表示代数を、域関数の城番号に前域表示代数を代入。

◆国集合に使用する城を決定(城ループ)
①管理城
(地方の場合条件付き:仮代数が1以上)国集合関数の前国表示代数を20で割り、0.95を加算、空白家の資金をその値にし(切り上げ)、国集合関数の前国表示代数に代入。調査代数に「前国表示代数+1」代入。一時代数に1代入。●を呼び出す。国集合関数の前国表示代数に1代入、前国表示代数に城番号代入。(地方:仮代数に0代入。)
②一般城
条件に関係なく、集合関数の城番号にＮ。
条件:武将が一人以上居る、城エリアがゼロ、プレーヤーか臣従の所有、包囲されていない
(地方:質問付き)結果:国集合関数の城番号にＹ代入。武将数を国集合関数の前国表示代数に加算。(地方:1代入)
●呼び出し専用(中継)
一時代数が国集合関数［前表示代数］未満なら、調査代数に1加算、▲を呼び出し、●を呼び出す。
▲呼び出し専用
条件:国集合関数の調査代数がＹ。武将数が20未満。
結果:国集合第二関数［前表示代数+一時代数］に調査代数を代入。(一時代数は1以上)
一時代数に1加算。国集合関数［調査代数］に「-Ｙ」代入。

◆国毎に集合 (武将ループ)
条件:当家の直属又は臣従、所在地が包囲されていない、国集合関数［一般城］が「Ｙ」と等しい、所在地武将数が20未満。
結果:国関数の武将所在城番号から所在国の国管理城を調べる。国集合関数の前国表示代数を一時代数に代入、国集合第二関数［一時代数+国管理城番号］をShiro1へ代入、
Shiro1に対象武将を移動。▽呼び出し。
▽呼び出し専用
Shiro1の武将数が20なら、国集合関数の前国表示代数に1加算。


●初月:関数設定、連盟について説明、表示させるイベントの選択

◆主要城、副主要城設定
国の中で番号の若い2城か1城について、4・10月にその支配者を表示する(勢力図情報)。
表示: 「城名:連盟(自立大名の直接支配家)」
■畿内
◆山城
◎二条城:徳川家連盟(徳川家の直轄支配)
○伏見城:徳川家連盟(徳川家の直轄支配)

●翌月:連盟結成

◆徳川譜代でも、実際に陣に参加している家ならば、徳川附属を離れて自立大名とし、開始時に強制的に徳川連盟に従属させる(但し、長澤松平、結城松平は独立大名)。

◆一族:初期の連盟設定で必ず同じ連盟に従属する。

◆自立大名同士の連盟結成

常時稼働のしくみと同じしくみ。ランダム大名を100回選択。

『111111111×111111111＝123456789876545321である』
返信 ▼
 削除 その他 ▼
 
Subject: 石高順位

置く場所:2,3,5,9,17,33,65,129,257,513…
2(An-1)+1=2An-1=Bn ⇔ An=(Bn+1)/2
全体数:3,5,9,17,33,65,129,257,513…

(以下、k=n+1とする。) 
n>1:An=Bk n=1:An=2

「B1=3,Bk=2Bn-1」より、
Bn-α=Cn ⇔ Bn=Cn+α と置くと、
Bk=Ck+α=2Cn+2α-1 ⇔ Ck=2Cn+α-1
ここで、α=1 とすると、C1=B1-α=2、
Cn=(2のn乗) ⇔ Bn=(2のn乗)+1

つまり、代入する大名数をnとするとき、
(2のn乗)+1 個の連続した引数が必要。
※引数全体の真ん中に大名番号を入れて石高順位をきめる場合。


＜大名常用関数＞
Syuke[LD] 初期外交での所属先(初期外交設定独立なら自分の番号)を返す。代理家のみ－60、滅亡すると0。天皇・浪人・裏方系は全て負の整数(主家の番号)。

Meisyu[LD] 大名・附属家共にイベント・自動外交による盟主の番号を返す。但し、従属家は負、臣従家は正の値。

FG[index] 附属家番号のグループ分け関数 
※index=(自立大名番号)*100+α
※α=0のとき、附属家数 / α=1～「α=0の値」のとき、附属家番号を各々返す。

ING[index] 自立大名のグループ分け関数 
※index=(盟主大名番号)*100+α
※α=0のとき、所属自立大名数 / α=1～「α=0の値」のとき、自立大名番号を返す。

＜城関数＞
Region[LS] と Country[LS](開始翌月以降)
国関数に国管理を代入すると国最後尾、
国関数に一般城を代入すると国管理城、
域関数に域管理を代入すると域最後尾、
域関数に一般城を代入すると域管理城。

Prelord[LS] 先月イベント終了時の城の所有家番号を返す。(開始翌月以降)

CArea[LS] 0一般・1マップ外・2大坂内・3福知山内部・4浪人用・5皇領・6国地方管理・7海外

＜代数＞
F 観戦型なら「1」、変動型なら「0」

DSTART～DEND 自由使用の代理家の範囲。
kantar 旧族同盟の大坂方参戦確率を返す。初期値は0.4(CE_200 ～外交と家臣団～)

victory 勝利の可能性のある家番号。
Kansen 観戦時のプレーヤー番号(CE_101設定)
SOUZYOUSU 城区分「一般」の拠点の数。

＜システムイベント＞
CE_0076 ABCに代入された値の絶対値化。
CE_0111 ChMonthの値を12以下へ(月処理)
CE_1004 城PreMoveの武将を城FolMoveへ。
CE_1003 城番号TSの石高を PreCC[TS] に返し、経済値を CECO[TS] に返す。
CE_0001 自立同盟・大名家全体の情報を取得する。石高、経済、城数、の順に、
同盟:MCrop[LD] MEco[LD] MShC[LD]
大名:DCrop[LD] DEco[LD] DShC[LD] 
CE_0003 大名TDの情報(CE_0001)を表示。
CE_0048 盟主TDの情報(CE_0001)を表示。


Subject: 代理家イベント
＜使用関数＞
家特定　DELE[LD]
一般番号代入：使用先代理家番号表示
代理家番号代入：使用元番号表示
未使用の時「0」

種特定　DUSE[LD]
代理家番号にのみ反応
未使用：0 従属謁見：1 従属派兵：2
援軍：3　特別格使用：4

指令元　DCOM[LD]
代理家番号のみに反応
指令もとの大名番号を表示
未使用：0

指令数 PDCOMC[index]
プレーヤーに関するもの
種別毎の指示先の合計数を表示
種別番号はDUSE[LD]に対応

＜使用代数＞
諸侯代表範囲　DSTART～DEND
指令元大名　DCALL
指令相手数　n
指令相手番号　TD
次の諸侯目付　s 
目付最終番号：d

＜他より＞
観戦大名番号定義　Kansen

慶長九年(=西暦1604年)六月頃 
「秀吉(故太閤)の七回忌をにぎやかに行いたい。」と豊国大明神(京都)が京都所司代に願い出 
献言イベント
諮問された金地院崇伝(家康の政治顧問の一人、大坂方討滅を主張)は、「朝廷や京都の民衆は徳川の時代になったということを十分に知っているはずだ。豐臣政権の再興を願う者はいないはず、人も集まらないだろう。」

家康の献言
「政治体制に関して対抗しなければならない前主権者を民衆に思い出させるような行事はできれば行いたくない。」 

八月 (許可の場合豊国祭) 
京都のあらゆる人々が町で踊り歩いた。紫宸殿(ししんでん)で天皇が町民の踊りを見物。
→大坂方政権の再興を上方は望んでいるのではないか？さすがに今何らかの手を打たねば先々不安(家康)

京都や大坂の町民の考え
「新興都市 江戸が日に日に栄えるに従って、政権を渡してしまった京都や大坂の町からだんだんにぎやかさがなくなってきてしまっている!」
以上は大坂方や朝廷へ 

六月 (不許可の場合)
京都町人衆が1500人大坂の下寺町へ九月に入る。 

家康将軍宣下直後
秀頼を内大臣(公家)にするように朝廷に奏上 
内大臣へ
「京都や大坂の強い反感を買ってはならない。一応の配慮を見せよう。」

封地変更
大坂の役への誘導
定期イベント災害の設置 
元和偃武宣言
堀…埋め立てるとレベル零になる 
紀伊一揆 
大坂農民勢力


Subject: 大名格
◆帰納的定義を利用できないか?
◆プレーヤー家所属の大名家とその盟主の情報は、7月と1月には必ず表示される。また、他の家の情報は、イベントの最後に意思表示によってみることができる。また、以下で記す情報は、「 」とする。
◆各国、「城」とつく拠点を上にし、つかない拠点を下に並び替える。
＜初月＞
◆大名当主の居る拠点を大名家中心拠点関数[大名]に代入。
◆武将「農民」を、各国管理城に、「～城」とつく拠点の数だけ配備。
◆管理家を滅亡させるのを遅らせる。
◆城ループ(城エリア設定と同時)。一般なら、代数が正の数ならば拠点格関数[城](一覧に未記入)1を代入。管理城なら、国管理なら、城にいる武将数を代数に代入。
◆以上で、拠点格関数[城]＞0なら城。
◆築城イベントの際、拠点格関数[城]に1加算を忘れずに。(加算→レベル計算に使う)


※Meisyu[LD]がマイナスとなる定義を確認、また各月の設定を上の方に持ってくる。

※情報表示の条件に「存在確認」を加える。また、ING関数やFG関数を使って出てきた自立大名や附属家が本当にその盟主や大名に従っているのか調べる条件が必要。

※DNinC[]をFG[]に全て置き換える。DNinC[]の設定を消し、下の「設定方法」に倣う。

◆附属家のグループ分け関数 FG[index]
※index=(自立大名番号)*100+α
※α=0のとき、附属家数 / α=1～「α=0の値」のとき、附属家番号を返す。

◆設定方法(4月のみ)
※大名ループで、以下はLD(附属家のみ)の時
・Syuke[LD]*100 を代数 index に代入
・FG[index] に 1 加算
・index に FG[index] 加算 
・FG[index] に LD 代入 
以上

※変更方法(他関数を含め自動イベントを作る)
・家臣団解散…その大名用の開始点から、「α=0の値」個のindexについて削除。
・特定家臣…自身イベント呼出式で、その家の番号が代入されているindexを探して削除、その大名の最後尾indexの家臣を空白となったところに代入、最後尾削除、「α=0」から1引く。
(上記、戦闘滅亡時を含む)
※特定大名情報調査に応用。

◆自立大名のグループ分け関数 ING[index]
※index=(盟主大名番号)*100+α
※α=0のとき、所属自立大名数 / α=1～「α=0の値」のとき、自立大名番号を返す。

◆設定方法(5月以降毎月)
※大名ループで、
以下はLD(盟主以外の自立大名のみ)の時
・LD*100 を代数 index に代入
・ING[index] に 1 加算
・index に IN[index] 加算 
・ING[index] に LD 代入 
以上

※特定盟主情報調査に応用。

※月の間に変更が在っても変えず、確認条件で乗りきる。配下大名数は全盟主情報調査でのみわかる。毎月確認するのは、外交変動があるため。


「体制崩壊」 用関数BG[index]
返信 ▼
 削除 その他 ▼
 
7月10日
詳細を表示
関数BG[index]に、２０万石を超えている独立大名の番号を、臣従込みの石高順に代入する場合。
但し、　index　は　大名番号とは関係ない整数変数、
1<=「index」<=(２０万石を超えている独立大名の数）

　　<イベントA>
結果:　indexに0を代入　　、　　Fに0を代入
　<イベントB>　
条件:　F　=　0　
結果:　index　に　1　加算　　　、　　F　に　1　代入
　　　イベントCを呼び出し
　　　イベントB自身を呼び出し

　　<イベントC>
条件:　　#石高順独立大名(index)　を　　変数「TD」に代入。
#石高(TD)　の値が　200000　よりも大きい。
結果:　　BG[index]　に　TD　代入
　　　　　F　に　0　代入


Subject:武将の相続
#武将番号（）　…未登場か死亡済みだと、０を返す

武将１を強制的に当主にする・・・「-1」でも、無理やり当主にする。ただし、その武将より継承順位が高い武将が居ると、自動的に当主権が奪われてしまうので、高い武将の継承順位を「１」に変える必要あり、当主に変えたい武将の継承順位を「0」に変える必要あり。

武将１の相続権所有大名家を大名１に変更…武将１の直接所属がかわらない限り、相続はしない

大名Ａの武将１を大名Ｂの当主にする・・
・武将１の継承順位を「0」に変更→大名Ｂの現当主の継承順位を「１」以下にする→武将１を大名Ｂの所属に変更→武将１の相続権所有大名家を大名Ｂに変更(→大名Ａの新当主を決定) 


Subject:城と武将

新しい領地を与える→旧領を没収
(同一イベント内)のとき、武将は自動で動いた！

　新しい領地を与える→旧領を没収
(同一イベント内)のとき、指定された場所に武将が入りきらないときあふれた武将は、番号の遅いものが城内武将としては表示されないが、確かに存在する。他の武将が居なくなって20人以下となると、表示される。

新しい領地を与える→旧領を没収→さらに新しい領地を与える→一度目の新領を与える 
> 
> > (同一イベント内)のとき、武将は自動で動いた！
> 
> 設定された登場場所が自分の大名の所有でないとき、大名に応じて登場場所を変える！ 
> 
> 
> #支配大名()は 直轄者を示す！
> 
> 石高は確実に整数値！で、０以下は０へ！最大石高は常に優先！
> 
> 変更後の大名の城に移動させなくても、武将の所属を変えれば、自動的に変更後の大名の城へ行く
> 
> 強制移動を命ぜられた城が自分の大名家のものでない場合、移動しない
> 
> 主家Ａと家臣家Ｂ
> 　Ｂの城をすべて、併合せずにイベントで他の家に移すと、城なし大名としてＡにそのまま家は存続して臣従。武将もそのまま。
ただし、攻められて移ると、Ｂは消滅。また、併合でも、Ｂは滅亡。

Subject: 国番号の作り方
①北から順に完全に国毎に城を、テキストエディタで並べる。地方内の順は気にしない。大坂は一色単にし、摂津の中へ。大坂と摂津を繋ぐ。
②大名に、空白家2家(国管理と地方管理)をつくる。Syuke[]は、他の空白家同様の値。観戦番号に1加算。大名は自動自滅。
③一日でわかる江戸時代P38を参照。城の国グループの頭に城を作り、名称を各々の国にし、所有を城管理家にする。(見えない所)地域毎にまとめ、国番号がわかるようにする。IDを国番号にする。地方についても同様。分割された国の場合は、「陸奥-白河」のようにする。城エリアはいずれも六。町拡大マップは各々の所属国に含ませる。
④イベント(５月の頭)1以上の城ループ
国管理家所有なら、国関数の前国表示代数に、城番号-1を代入、代数に城番号代入。
域管理家所有なら、域関数の前域表示代数に、城番号-1を代入、代数に城番号代入。
上記二点以外なら、国関数の城番号に前国表示代数を、域関数の城番号に前域表示代数を代入。


皇神(すめがみ)は よき日祭りつ 明日よりは 八百萬世(やおよろずよ)を 祈るばかりぞ 天皇家勝利の時

銀(しろがね)の ぬぬきの太刀を 提げ佩きて 奈良の都を ねるは 誰が子ぞ 

榊葉の 香をかぐはしみ とめくれば 八十氏人ぞ まとゐせりける

わがあれば みな人しらず 父が方 母が方とも 神はしるらし

四方山の 守りに頼む 梓弓 神の寶に 今しつるかな

笹の葉に 雪降り積もる 冬の夜に 豊の遊びを するが楽しさ 

いはひ来し 神はまつりつ 明日よりは 組の緒垂(をし)でて 遊べ太刀佩き

太鹿頭、千鹿頭神、高藤、七十五、天の真鹿児矢

鹿島神宮と守屋山山頂をつなぐと真東西線

春日大社～諏訪神社～福井の諏訪地方は直線

諏訪大社～鹿島槍ヶ岳～能登の諏訪郡、鎌宮諏訪神社 直線

奥山の大木 里にくだりて 神となる


その時歴史が動いた 最後の言葉 松平定知

人間の魅力こそが歴史

歴史は勝者のためだけにあるのではない

歴史は新しいもの
(新しい切口から歴史をみる)

源氏と日本国王 by岡野友彦 
「何人も自己の有する以上の権利を他人に付与することは出来ない」ローマ法より

支配の正当性 マックス・ウェーバー 
伝統的支配、カリスマ的支配、合法的支配(暴力的支配がない)

姓と苗字 
・姓は天皇が公的に臣下に与えるものであるが、苗字は私称するものである。
・姓は父系血縁関係(⇒血族全体)によって継承されるが、苗字は家という社会組織(⇒親族集団)の名前である。
・天皇家に姓がないのは与えられる上位の者がいないからであり、天皇一族に姓を与えるということは、則ち天皇一族を離れて臣下となることを意味した。(＝賜姓臣籍降下)各源氏や平氏へ
・「氏姓＋名前」には間に[の]が入るが、「苗字＋名前」には入らない。
・但し明治以後は混合、苗字必称令によって、姓にちなんで新たにつくられた苗字もある。 
・豊臣秀吉の姓は「豊臣」(新規創設)、苗字は「羽柴」であり、「豊臣氏羽柴家」が正しい。また、豊臣秀吉は「とよとみのひでよし」と読むのが正しい。秀頼もまた然り。
・天皇には姓は生じてはならないので、天皇は男子皇族によって継承されるため、天皇家に外部からの婿養子はない。


旧皇族が語る天皇の日本史 竹田恒泰php
大坂の陣 戦況図録 新人物往来社(大坂の町地図が、30ページ、戦況については詳しい)
江戸開府と幕藩体制 小和田哲男 の後半
定本常山紀談 上下 湯浅常山 
関ヶ原合戦と近世の国制 笠谷和比古 
関ヶ原から大坂の陣へ 小和田哲男
大坂の陣 二木謙一 
関ヶ原合戦四百年の謎 笠谷和比古 
地理から見た信長・秀吉・家康の戦略 足利健亮 (雑誌)
正伝直江兼続 渡邊三省 
城塞上中下 司馬遼太郎
天領の成立と変遷 村上直
徳川家康事典コンパクト版 村上直など
